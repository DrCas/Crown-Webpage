<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portfolio - Crown GFX</title>

  <!-- Fonts + CSS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Header -->
  <header>
    <div class="container nav">
      <a href="index.html" class="logo-link">
        <img src="images/HeaderLogo.png" alt="Crown GFX Logo" class="site-logo">
      </a>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="portfolio.html" class="active">Portfolio</a></li>
          <li><a href="/order">Order</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Banner -->
  <section class="page-banner" style="background-image: url('images/Front Wall Wrap.jpg');">
    <h2>Portfolio</h2>
  </section>

  <!-- Slider -->
  <section class="container">
    <div class="slider" id="portfolioSlider">
      <button class="slider-btn prev" aria-label="Previous slide">&#10094;</button>
      <div class="slides" id="slidesTrack"><!-- slides injected by JS --></div>
      <button class="slider-btn next" aria-label="Next slide">&#10095;</button>
    </div>
    <div class="slider-dots" id="sliderDots"><!-- dots injected by JS --></div>
    <p id="sliderStatus" class="slider-status"></p>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>&copy; 2025 Crown GFX | All Rights Reserved</p>
    </div>
  </footer>

  <!-- Slider script (v3) -->
  <script>
/**
 * Slider v5 â€” Fade transition + autoplay with pause-on-hover
 * - Loads images named slide-#.ext from images/collections/slides/
 * - Supports jpg/jpeg/png/webp (any case)
 * - Fades between slides; dots/buttons/keys/swipe work
 * - Autoplay every 5s; pauses while hovered
 */
(function () {
  const FOLDER   = "images/Collection/Slides/";
  const BASENAME = 'slide-';
  const exts     = ['jpg','jpeg','png','webp','JPG','JPEG','PNG','WEBP'];
  const START_AT = 1;     // lowest number to check
  const END_AT   = 200;   // highest number to check
  const AUTOPLAY_MS = 5000;

  const sliderEl    = document.getElementById('portfolioSlider');
  const slidesTrack = document.getElementById('slidesTrack');
  const dotsWrap    = document.getElementById('sliderDots');
  const statusEl    = document.getElementById('sliderStatus');
  const prevBtn     = document.querySelector('.slider-btn.prev');
  const nextBtn     = document.querySelector('.slider-btn.next');

  if (!sliderEl || !slidesTrack || !dotsWrap || !prevBtn || !nextBtn) {
    console.error('Slider elements not found. Check IDs: portfolioSlider, slidesTrack, sliderDots, buttons.');
    return;
  }

  let images = [];
  let idx = 0;
  let autoplayId = null;
  let startX = null;

  function candidateUrls(n) {
    return exts.map(ext => `${FOLDER}${BASENAME}${n}.${ext}`);
  }

  function addSlide(url) {
    images.push(url);

    // Slide element
    const fig = document.createElement('figure');
    fig.className = 'slide' + (images.length === 1 ? ' active' : '');
    const img = document.createElement('img');
    img.src = url;
    img.alt = `Portfolio image ${images.length}`;
    fig.appendChild(img);
    slidesTrack.appendChild(fig);

    // Dot
    const dot = document.createElement('button');
    dot.className = 'dot' + (images.length === 1 ? ' active' : '');
    dot.setAttribute('aria-label', `Go to slide ${images.length}`);
    dot.addEventListener('click', () => goTo(images.length - 1));
    dotsWrap.appendChild(dot);

    updateStatus();
  }

  // Try each index; keep the first extension that loads
  function tryIndex(n) {
    return new Promise(resolve => {
      let done = false;
      let remaining = exts.length;

      candidateUrls(n).forEach(url => {
        const img = new Image();
        img.onload = () => {
          if (!done) {
            done = true;
            addSlide(url);
            resolve(true);
          }
        };
        img.onerror = () => {
          remaining--;
          if (!done && remaining === 0) resolve(false);
        };
        img.src = url;
      });
    });
  }

  async function buildAll() {
    for (let n = START_AT; n <= END_AT; n++) {
      // eslint-disable-next-line no-await-in-loop
      await tryIndex(n);
    }
    if (images.length) startAutoplay();
    else statusEl.textContent = "No images found. Check folder/filenames.";
  }

  function setActive(i) {
    idx = (i + images.length) % images.length;
    const slides = Array.from(slidesTrack.children);
    const dots = Array.from(dotsWrap.children);

    slides.forEach((el, j) => el.classList.toggle('active', j === idx));
    dots.forEach((d, j) => d.classList.toggle('active', j === idx));
    updateStatus();
  }

  function updateStatus() {
    statusEl.textContent = images.length ? `${idx + 1} / ${images.length}` : '';
  }

  function prev() { if (!images.length) return; setActive(idx - 1); restartAutoplay(); }
  function next() { if (!images.length) return; setActive(idx + 1); restartAutoplay(); }
  function goTo(i) { if (!images.length) return; setActive(i); restartAutoplay(); }

  // Buttons & keyboard
  prevBtn.addEventListener('click', prev);
  nextBtn.addEventListener('click', next);
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') prev();
    if (e.key === 'ArrowRight') next();
  });

  // Touch swipe (trigger once per swipe)
  slidesTrack.addEventListener('touchstart', e => { startX = e.touches[0].clientX; }, { passive: true });
  slidesTrack.addEventListener('touchmove',  e => {
    if (startX === null) return;
    const dx = e.touches[0].clientX - startX;
    if (Math.abs(dx) > 50) { (dx > 0 ? prev : next)(); startX = null; }
  }, { passive: true });
  slidesTrack.addEventListener('touchend', () => { startX = null; });

  // Autoplay + pause on hover
  function startAutoplay() { stopAutoplay(); autoplayId = setInterval(next, AUTOPLAY_MS); }
  function stopAutoplay()  { if (autoplayId) clearInterval(autoplayId); autoplayId = null; }
  function restartAutoplay(){ startAutoplay(); }

  sliderEl.addEventListener('mouseenter', stopAutoplay);
  sliderEl.addEventListener('mouseleave', startAutoplay);

  // Go!
  buildAll();
})();
</script>
</body>
</html>
